<?php
$disabled = "";
?>

<div class="wrap">

	<div id="icon-tools" class="icon32"></div>
	<h2>
		CDN Sync Tool - Options
	</h2>
	
	<?php if ( isset($errorArray) && !empty($errorArray) ) { ?>
		<ul class="error">
			<?php foreach($errorArray as $error ){ ?>
				<li><?php echo $error; ?></li>
			<?php } ?>
		</ul>
	<?php } ?>
	
	<div id="dashboard-widgets-wrap">
		<div id="dashboard-widgets">
			<div id="post-body">
				<div id="dashboard-widgets-main-content" >
					<div class="postbox-container" style="width:75%">
						<div class="metabox-holder">
							<div id="left-sortables" class="meta-box-sortables ui-sortable">
								<form method="post" action="<?php echo $_SERVER["REQUEST_URI"]; ?>">
								<div id="dashboard_cdn" class="postbox">
									<div class="handlediv" title="Click to toggle">
										<br />
									</div>
									<h3 class="hndle">
										<span>CDN Provider</span>
									</h3>
									<div class="inside">
										<table class="form-table">
											<tr class="general_details">
												<th scope="row">Content Delivery Network</th>
												<td>
													<select name="cdn_provider" id="cdn" <?php echo $disabled; ?>>
														<option value="" <?php if ( (!isset($cdn) || !is_array($cdn) ) || (!isset($cdn["provider"]) || empty($cdn["provider"]) ) ){ ?> selected="selected"<?php } ?>>N/A</option>
														<option value="aws" <?php if ((isset($cdn) && is_array($cdn) ) && (isset($cdn["provider"]) && $cdn["provider"] == "aws")){ ?> selected="selected"<?php } ?>>Amazon S3/CloudFront</option>
														<option value="cf" <?php if ((isset($cdn) && is_array($cdn) ) && (isset($cdn["provider"]) && $cdn["provider"] == "cf")){ ?> selected="selected"<?php } ?>>Cloudfiles</option>
													</select>
												</td>
											</tr>
											<tr>
												<td colspan="2">The CDN service that will be used. If the CDN service is not in this list then it is not support. If you want to use a service not supported <a href="<?php echo get_bloginfo('url'); ?>/wp-admin/admin.php?page=<?php echo CST_PAGE_CONTACT; ?>">click here</a> and tell and link us to the service.</td>
											</tr>
											<tr class="even">
												<th scope="row">Hostname</th>
												<td><input type="text" name="cdn_hostname" value="<?php if ((isset($cdn) && is_array($cdn) ) && isset($cdn["hostname"])){ echo $cdn["hostname"]; } ?>" <?php echo $disabled; ?> /></td>
											</tr>
											<tr class="even">
												<td colspan="2">The URL of your cdn, so if your cdn files will be at cdn.catn.com you should put in "<em>http://cdn.catn.com</em>"</td>
											</tr>
											<tr>
												<th scope="row">Anti-Hotlinking</th>
												<td>
													<input type="radio" name="cdn_hotlinking" value="no" id="hotlinking_no" <?php if ((!isset($cdn) || !is_array($cdn)) || (!isset($cdn["hotlinking"]) || $cdn["hotlinking"] == "no")){ ?> checked="checked" <?php } ?> />
													<label for="hotlinking_no">No</label>
													<input type="radio" name="cdn_hotlinking" value="yes" id="hotlinking_yes" <?php if ((isset($cdn) && is_array($cdn)) && (isset($cdn["hotlinking"]) && $cdn["hotlinking"] == "yes")){ ?> checked="checked" <?php } ?>  />
													<label for="hotlinking_yes">Yes</label>
												</td>
											</tr>
											<tr>
												<td colspan="2">This creates it so images can only by browsers giving the site url as referrer or directly. There can be multiple reasons why there is no referrer such as SSL usage. <b>This currently does not work with CloudFront. <font color="#FF0000">This will result in files not working in CloudFront</font></b></td>
											</tr>
											<tr class="aws_details even">
												<th scope="row">AWS Access Key</th>
												<td>	
													<input type="text" name="aws_access" value="<?php if ((isset($cdn) && is_array($cdn) ) &&(isset($cdn["provider"]) || $cdn["provider"] == "aws") && isset($cdn["access"])){ echo $cdn["access"]; } ?>" <?php echo $disabled; ?> />
												</td>
											</tr>
											<tr class="aws_details even">
												<td colspan="2">The Access key for your AWS account. Can be found <a href="https://aws-portal.amazon.com/gp/aws/developer/account/index.html?ie=UTF8&action=access-key" target="_blank">here</a>.</td>
											</tr>
											<tr class="aws_details">
												<th scope="row">AWS Secret Key</th>
												<td>
													<input type="text" name="aws_secret" value="<?php if ((isset($cdn) && is_array($cdn) ) &&(isset($cdn["provider"]) || $cdn["provider"] == "aws") && isset($cdn["secret"])){ echo $cdn["secret"]; } ?>" <?php echo $disabled; ?> />
												</td>
											</tr>
											<tr class="aws_details">
												<td colspan="2">The Secret key for your AWS account. Can be found <a href="https://aws-portal.amazon.com/gp/aws/developer/account/index.html?ie=UTF8&action=access-key" target="_blank">here</a>.</td>
											</tr>
											<tr class="aws_details even">
												<th scope="row">AWS Bucket</th>
												<td>
													<input type="text" name="aws_bucket" value="<?php if ((isset($cdn) && is_array($cdn) ) && (isset($cdn["provider"]) && $cdn["provider"] == "aws") && isset($cdn["bucket"])){ echo $cdn["bucket"]; } ?>" <?php echo $disabled; ?> />
												</td>
											</tr>
											<tr class="aws_details even">
												<td colspan="2">This is where you want the files uploaded to. You can create/edit buckets <a href="http://console.amazon.com" target="_blank">here</a>.</td>
											</tr>
											<tr class="aws_details">
												<th scope="row">Create Bucket</th>
												<td>
													<input type="checkbox" name="create_bucket" value="" <?php echo $disabled; ?> /> Create a new bucket.
												</td>
											</tr>
											<tr class="cf_details even">
												<th scope="row">Username</th>
												<td><input type="text" name="cf_username" value="<?php if ((isset($cdn) && is_array($cdn) ) &&(isset($cdn["provider"]) || $cdn["provider"] == "cf") && isset($cdn["username"])){ echo $cdn["username"]; } ?>" /></td>
											</tr>
											<tr class="cf_details even">
												<td colspan="2">Username for your CloudFiles account.</td>
											</tr>
											<tr class="cf_details">
												<th scope="row">API Key</th>
												<td><input type="text" name="cf_apikey" value="<?php if ((isset($cdn) && is_array($cdn) ) &&(isset($cdn["provider"]) || $cdn["provider"] == "cf") && isset($cdn["apikey"])){ echo $cdn["apikey"]; } ?>" /></td>
											</tr>
											<tr class="cf_details">
												<td colspan="2">API key for your CloudFiles account.</td>
											</tr>	
											<tr class="cf_details even">
												<th scope="row">Container</th>
												<td><input type="text" name="cf_container" value="<?php if ((isset($cdn) && is_array($cdn) ) &&(isset($cdn["provider"]) || $cdn["provider"] == "cf") && isset($cdn["container"])){ echo $cdn["container"]; } ?>" /></td>
											</tr>
											<tr class="cf_details even">
												<td colspan="2">Username for your CloudFiles account.</td>
											</tr>
										</table>
										<a href="#" class="button-secondary" id="check-details">Check Details</a>
										<input type="submit" class="button-primary" value="Save" <?php echo $disabled; ?> />
									</div> 
									
								</div>
								
								<div id="dashboard_js_css" class="postbox">
									<div class="handlediv" title="Click to toggle">
										<br />
									</div>
									<h3 class="hndle">
										<span>JS & CSS</span>
									</h3>
									<div class="inside">
										<table class="form-table">
											<tr>
												<th scope="row">Combine files</th>
												<td>
													<input <?php echo $disabled; ?> type="radio" name="combine" value="yes" id="combine_yes" <?php if ((isset($files) && is_array($files) ) && (isset($files["combine"]) && $files["combine"] == "yes")){ ?>checked="checked"<?php } ?> /> <label for="combine_yes">Yes</label>
													<input <?php echo $disabled; ?> type="radio" name="combine" value="no" id="combine_no" <?php if ((!isset($files) || !is_array($files) ) || (!isset($files["combine"]) || $files["combine"] == "no")){ ?>checked="checked"<?php } ?> /> <label for="combine_no">No</label>
												</td>
											</tr>
											<tr>
												<td colspan="2">Combine all CSS files into a single CSS file and all JavaScript files into a single file. Reduces HTTP requests.</td>
											</tr>
											<tr class="even">
												<th scope="row">Minify Engine</th>
												<td>
													<select name="minify_engine" id="minify">
														<option value="none">None</option>
														<option value="google">Google Closure Compiler</option>
														<opiton value="php-minify">PHP-Minify</option>
													</select>
												</td>
											</tr>
											<tr class="even google_minify">
												<th scope="row">Level</th>
												<td>
													<select name="google_level">
														<option value="whitespace">Whitespace Only</option>
														<option value="simple">Simple Code Optimization</option>
														<option value="advance">Advance Code Optimization</option>
													</select>
											</tr>
											<tr class="even">
												<td colspan="2">The minify engine to be used. If none is selected there will be no minifcation attempt done. <b>Note : Use of Google Closure Compiler will increase build time and has API limits but is more advanced.</b></td>
											</tr>
											<tr>
												<th scope="row">Save Directory</th>
												<td>
													<input type="text" name="directory" value="<?php if ((isset($files) && is_array($files) ) && (isset($files["directory"]) && !empty($files["directory"])) ) { echo $files["directory"]; } else { echo "wp-content/uploads"; }  ?>" />
												</td>
											</tr>
											<tr>
												<td colspan="2">The directory to save all the build files.</td>
											</tr>
											<tr class="even">
												<th scope="row">Include external hosted files</th>
												<td>
													<input <?php echo $disabled; ?> type="radio" name="external" value="yes" id="external_yes" <?php if ((isset($files) && is_array($files) ) && (isset($files["external"]) && $files["external"] == "yes" )){ ?>checked="checked"<?php } ?>  /> <label for="external_yes">Yes</label>
													<input <?php echo $disabled; ?> type="radio" name="external" value="no" id="external_no" <?php if ((!isset($files) || !is_array($files) ) || (!isset($files["external"]) || $files["external"] == "no")){ ?>checked="checked"<?php } ?>  /> <label for="external_no">No</label>
												</td>
											</tr>
											<tr>
												<td colspan="2">Include external hosted JavaScript or CSS in the single files or to leave them alone. Generally this is a good idea.</td>
											</tr>
											<tr>
												<th scope="row">Exclude CSS files</th>
												<td>
													<textarea <?php echo $disabled; ?> name="exclude_css" rows="5" cols="40"><?php if ((isset($files) && is_array($files) ) &&  isset($files["exclude_css"]) ) { echo $files["exclude_css"]; } ?></textarea>
												</td>
											</tr>
											<tr>
												<td colspan="2">List of CSS files that aren't to be to be combined into the single file and to be left alone. One per line.</td>
											</tr>
											<tr class="even">
												<th scope="row">Exclude JS files</th>
												<td>
													<textarea <?php echo $disabled; ?> name="exclude_js" rows="5" cols="40"><?php if ((isset($files) && is_array($files) ) && isset($files["exclude_js"]) ) { echo $files["exclude_js"]; } ?></textarea>
												</td>
											</tr>
											<tr class="even">
												<td colspan="2">List of Javascript files that aren't to be to be combined into the single file and to be left alone. One per line.</td>
											</tr>
										</table>
										
										<input type="submit" <?php echo $disabled; ?> class="button-primary" value="Save" />
									</div> 
									
								</div>
								
								<div id="dashboard_image" class="postbox">
									<div class="handlediv" title="Click to toggle">
										<br />
									</div>
									<h3 class="hndle">
										<span>Images</span>
									</h3>
									<div class="inside">
										<table class="form-table">
											<tr>
												<th scope="row">Smush Images via Smush.It</th>
												<td>
													<input <?php echo $disabled; ?> type="radio" name="smush" value="yes" id="smush_yes" <?php if ((isset($files) && is_array($files) ) && (isset($images["smush"]) && $images["smush"] == "yes")){ ?>checked="checked"<?php } ?> /> <label for="smush_yes">Yes</label>
													<input <?php echo $disabled; ?> type="radio" name="smush" value="no" id="smush_no" <?php if ((!isset($files) || !is_array($files) ) || (!isset($images["smush"]) || $images["smush"] == "no")){ ?>checked="checked"<?php } ?> /> <label for="smush_no">No</label>
												</td>
											</tr>
											<tr>
												<td colspan="2">A lossless compression where useless image meta data is stripped away.</td>
											</tr>
											<tr class="even">
												<th scope="row">Compress Images via GD</th>
												<td>
													<input <?php echo $disabled; ?> type="radio" name="compress" value="yes" id="compress_yes" <?php if ((isset($files) && is_array($files) ) && (isset($images["compress"]) && $images["compress"] == "yes")){ ?>checked="checked"<?php } ?> /> <label for="compress_yes">Yes</label>
													<input <?php echo $disabled; ?> type="radio" name="compress" value="no" id="compress_no" <?php if ((!isset($files) || !is_array($files) ) || (!isset($images["compress"]) || $images["compress"] == "no")){ ?>checked="checked"<?php } ?> /> <label for="compress_no">No</label>
												</td>
											</tr>
											<tr class="even">
												<td colspan="2">A lossful compression where GD library is used to compress the image. Will affect the quality of the picture.</td>
											</tr>
										</table>
										
										<input <?php echo $disabled; ?> type="submit" class="button-primary" value="Save" />
									</div> 
									
								</div>								
								<div id="dashboard_misc" class="postbox">
									<div class="handlediv" title="Click to toggle">
										<br />
									</div>
									<h3 class="hndle">
										<span>Misc</span>
									</h3>
									<div class="inside">
										<table class="form-table">
											<tr class="even">
												<th scope="row">Powered by</th>
												<td>
													<input <?php echo $disabled; ?> type="radio" name="powered_by" value="yes" id="powered_by_yes" <?php if ((!isset($general) || !is_array($general) ) && !isset($general["powered_by"]) || $general["powered_by"] == "yes"){ ?>checked="checked"<?php } ?> /> <label for="powered_by_yes">Yes</label>
													<input <?php echo $disabled; ?> type="radio" name="powered_by" value="no" id="powered_by_no" <?php if ((isset($general) && is_array($general) ) || isset($general["powered_by"]) && $general["powered_by"] == "no"){ ?>checked="checked"<?php } ?> /> <label for="powered_by_no">No</label>
												</td>
											</tr>
											<tr class="even">
												<td colspan="2">Tell the world that you're site is using this plugin and a friendly link to our site. Best and easiest way to thank us for our work.</td>
											</tr>
										</table>
										<input <?php echo $disabled; ?> type="submit" class="button-primary" value="Save" />
									</div> 
									</form>
								</div>
							</div>
						</div>
					</div>
					<div class="postbox-container" style="width:20%">
											
						<div class="metabox-holder">
							<div id="right-sortables" class="meta-box-sortables ui-sortable">
								<div id="dashboard_catn" class="postbox">
									<div class="handlediv" title="Click to toggle">
										<br />
									</div>
									<h3 class="hndle">
										<span>CatN Hosting</span>
									</h3>
									<div class="inside">
										<p>Develop Host and Optimise your PHP applications with the CatN vCluster.</p>
										<p>Scalable, high performance PHP hosting, perfect for Wordpress. <a href="http://catn.com/?ref=cst" target="_blank">Click here</a> for more information.</p>
									</div>
								</div>
								
								<div id="dashboard_sync" class="postbox">
									<div class="handlediv" title="Click to toggle">
										<br />
									</div>
									<h3 class="hndle">
										<span>Sync Files</span>
									</h3>
									<div class="inside">
										
										<form method="post" action="<?php echo $_SERVER['REQUEST_URI']; ?>" class="thickbox">
											<p>Syncs the Media Library and Theme files with the CDN.</p>
											<p>
												<input <?php echo $disabled; ?> type="checkbox" name="theme" value="yes" checked="yes" id="theme_files" />
												<label for="theme_files">Theme files</label> 
												<input <?php echo $disabled; ?> type="checkbox" name="media" value="yes" checked="yes" id="media_files" />
												<label for="media_files">Media Library</label>
												<br />
												<input <?php echo $disabled; ?> type="checkbox" name="wpinclude" value="yes" checked="yes" id="wpinclude" />
												<label for="wpinclude">WP Files</label>
												<input <?php echo $disabled; ?> type="checkbox" name="wpplugin" value="yes" checked="yes" id="wpplugin" />
												<label for="wpplugin">Plugin Files</label>
											</p>
											<input type="checkbox" name="force" value="yes" id="force" />
											<label for="override">Don't skip already sync'd</label>
											<input type="hidden" name="showsync" value="yes" />
											<p>
												<input <?php echo $disabled; ?> type="submit" class="button-primary" value="Sync Files" id="upload-options" />
											</p>
										</form>
										
									</div>
								</div>
								
								<div id="dashboard_dir_sync" class="postbox">
									<div class="handlediv" title="Click to toggle">
										<br />
									</div>
									<h3 class="hndle">
										<span>Sync Single Directory</span>
									</h3>
									<div class="inside">
										
										<form method="post" action="<?php echo $_SERVER['REQUEST_URI']; ?>">
											<p>Syncs a specficied directory to CDN</p>
											<p>
												<label for="directory">Directory</label>
												<input <?php echo $disabled; ?> type="text" name="directory" id="theme_files" />
												
											</p>
											<input type="checkbox" name="force" value="yes" id="force" />
											<label for="override">Don't skip already sync'd</label>
											<input type="hidden" name="showsync" value="yes" />
											<p>
												<input <?php echo $disabled; ?> type="submit" class="button-primary" value="Sync Files" />
											</p>
										</form>
										
									</div>
								</div>
							</div>
						</div>
						
					</div>
				</div>
			</div>
		</div>
	</div>
<?php require_once CST_DIR.'/pages/misc/image.html'; ?>